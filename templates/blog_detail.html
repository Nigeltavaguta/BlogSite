{% extends "base.html" %}
{% load static %}
{% block header %}
    <!-- header (matches index.html exactly) -->
    <header class="header-default">
        <nav class="navbar navbar-expand-lg">
            <div class="container-xl">
                <!-- site logo -->
                <a class="navbar-brand" href="{% url 'index' %}">
                    <span class="custom-logo">
                        Nigel<span class="custom-dot">.</span>
                    </span>
                </a>
                <div class="collapse navbar-collapse">
                    <!-- menus -->
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="{% url 'index' %}">Home</a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'index' %}">Magazine</a></li>
                            </ul>
                        </li>
                        {% for category in categories %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'category' category.slug %}">{{ category.name }}</a>
                        </li>
                        {% endfor %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#">Pages</a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'about' %}">About</a></li>
                                <li><a class="dropdown-item" href="{% url 'contact' %}">Contact</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div class="header-right">
                    <ul class="social-icons list-unstyled list-inline mb-0">
                        <li class="list-inline-item"><a href="#"><i class="fab fa-facebook-f"></i></a></li>
                        <li class="list-inline-item"><a href="#"><i class="fab fa-twitter"></i></a></li>
                        <li class="list-inline-item"><a href="#"><i class="fab fa-instagram"></i></a></li>
                        <li class="list-inline-item"><a href="#"><i class="fab fa-linkedin"></i></a></li>
                    </ul>
                    <div class="header-buttons">
                        <button class="search icon-button">
                            <i class="icon-magnifier"></i>
                        </button>
                    </div>
                </div>
            </div>
        </nav>
    </header>
{% endblock header %}

{% block body %}
    <!-- main content -->
    <section class="main-content mt-3">
        <div class="container-xl">
            <!-- breadcrumbs -->
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'index' %}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'category' post.category.slug %}">{{ post.category.name }}</a></li>
                    <li class="breadcrumb-item active">{{ post.title }}</li>
                </ol>
            </nav>

            <div class="row gy-4">
                <div class="col-lg-8">
                    <!-- post single -->
                    <div class="post post-single">
                        <!-- post header -->
                        <div class="post-header">
                            <h1 class="title mt-0 mb-3">{{ post.title }}</h1>
                            <ul class="meta list-inline mb-0">
                                <li class="list-inline-item">
                                    <a href="#">
                                        {% if post.author.profile_image %}
                                            <img src="{{ post.author.profile_image.url }}" class="author" alt="{{ post.author }}">
                                        {% else %}
                                            <img src="{% static 'images/other/author-sm.png' %}" class="author" alt="{{ post.author }}">
                                        {% endif %}
                                        {{ post.author.get_full_name }}
                                    </a>
                                </li>
                                <li class="list-inline-item">{{ post.created_at|date:"F d, Y" }}</li>
                                <li class="list-inline-item"><i class="icon-clock"></i> {{ post.read_time }} min read</li>
                            </ul>
                        </div>
                        
                        <!-- featured image -->
                        <div class="featured-image">
                            <img src="{{ post.image.url }}" alt="{{ post.title }}" class="img-fluid rounded">
                        </div>
                        
                        <!-- post content -->
                        <div class="post-content clearfix mt-4">
                            {{ post.content|safe }}
                        </div>
                        
                        <!-- post tags -->
                        <div class="post-bottom mt-4">
                            <div class="row d-flex align-items-center">
                                <div class="col-md-6 col-12">
                                    {% for tag in post.tags.all %}
                                    <a href="{% url 'tag' tag.slug %}" class="tag">#{{ tag.name }}</a>
                                    {% endfor %}
                                </div>
                                <div class="col-md-6 col-12">
                                    <ul class="social-icons list-unstyled list-inline mb-0 float-md-end">
                                        <li class="list-inline-item"><a href="#"><i class="fab fa-twitter"></i></a></li>
                                        <li class="list-inline-item"><a href="#"><i class="fab fa-linkedin"></i></a></li>
                                        <li class="list-inline-item"><a href="#"><i class="fab fa-facebook"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- about author -->
                    <div class="about-author padding-30 rounded mt-5">
                        <div class="thumb">
                            {% if post.author.profile_image %}
                                <img src="{{ post.author.profile_image.url }}" alt="{{ post.author.username }}" class="rounded-circle">
                            {% else %}
                                <img src="{% static 'images/other/avatar-about.png' %}" alt="{{ post.author.username }}" class="rounded-circle">
                            {% endif %}
                        </div>
                        <div class="details">
                            <h4 class="name">{{ post.author.get_full_name }}</h4>
                            <p class="mb-3">{{ post.author.bio }}</p>
                            <ul class="social-icons list-unstyled list-inline mb-0">
                                <li class="list-inline-item"><a href="#"><i class="fab fa-github"></i></a></li>
                                <li class="list-inline-item"><a href="#"><i class="fab fa-twitter"></i></a></li>
                                <li class="list-inline-item"><a href="#"><i class="fab fa-linkedin"></i></a></li>
                            </ul>
                        </div>
                    </div>

                    <!-- comments section -->
                    <div class="comments-section mt-5">
                        <div class="section-header">
                            <h3 class="section-title">Comments ({{ comments.count }})</h3>
                            <img src="{% static 'images/wave.svg' %}" class="wave" alt="wave">
                        </div>
                        
                        <div class="comments bordered padding-30 rounded">
                            {% for comment in comments %}
                            <div class="comment rounded mb-3">
                                <div class="thumb">
                                    <img src="{% static 'images/other/comment-1.png' %}" alt="{{ comment.name }}" class="rounded-circle">
                                </div>
                                <div class="details">
                                    <h5 class="name mb-1">{{ comment.name }}</h5>
                                    <span class="date text-muted small">{{ comment.created_at|date:"F d, Y" }}</span>
                                    <p class="mt-2 mb-2">{{ comment.content }}</p>
                                </div>
                            </div>
                            {% empty %}
                            <p class="text-center py-3">No comments yet. Be the first to comment!</p>
                            {% endfor %}
                        </div>

                        <!-- comment form -->
                        <div class="comment-form mt-4">
                            <div class="section-header">
                                <h3 class="section-title">Leave Comment</h3>
                                <img src="{% static 'images/wave.svg' %}" class="wave" alt="wave">
                            </div>
                            
                            <form method="post" action="{% url 'add_comment' post.slug %}" class="rounded bordered padding-30">
                                {% csrf_token %}
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <input type="text" name="name" class="form-control" placeholder="Your Name" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <input type="email" name="email" class="form-control" placeholder="Your Email" required>
                                    </div>
                                    <div class="col-12 mb-3">
                                        <textarea name="content" class="form-control" rows="5" placeholder="Your Comment" required></textarea>
                                    </div>
                                    <div class="col-12">
                                        <button type="submit" class="btn btn-default">Post Comment</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- sidebar (matches index.html style) -->
                <div class="col-lg-4">
                    {% include 'partials/sidebar.html' %}
                </div>
            </div>
        </div>
    </section>
{% endblock body %}